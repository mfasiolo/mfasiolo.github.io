<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>QQ plots for gam model residuals — qq.gamViz • mgcViz</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="QQ plots for gam model residuals — qq.gamViz" />

<meta property="og:description" content="Takes a fitted gam object, converted using getViz, and produces QQ plots of its residuals
(conditional on the fitted model coefficients and scale parameter). If the model distributional
assumptions are met then usually these plots should be close to a straight line (although
discrete data can yield marked random departures from this line)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mgcViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BayesPost.html">Bayesian posterior simulations and predictive checks</a>
    </li>
    <li>
      <a href="../articles/mgcviz.html">An introduction to mgcViz: visual tools for GAMs</a>
    </li>
    <li>
      <a href="../articles/miscellanea.html">Miscellanea: things you can do in mgcViz</a>
    </li>
    <li>
      <a href="../articles/qgam_mgcViz.html">Quantile additive models using qgam and mgcViz</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mfasiolo/mgcViz">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>QQ plots for gam model residuals</h1>
    <small class="dont-index">Source: <a href='https://github.com/mfasiolo/mgcViz/blob/master/R/qq_gamViz.R'><code>R/qq_gamViz.R</code></a></small>
    <div class="hidden name"><code>qq.gamViz.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Takes a fitted gam object, converted using <a href='getViz.html'>getViz</a>, and produces QQ plots of its residuals
(conditional on the fitted model coefficients and scale parameter). If the model distributional
assumptions are met then usually these plots should be close to a straight line (although
discrete data can yield marked random departures from this line).</p>
    
    </div>

    <pre class="usage"><span class='co'># S3 method for gamViz</span>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>o</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"auto"</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>worm</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sortFun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ngr</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>a.qqpoi</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='kw'>a.ablin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(),
  <span class='kw'>a.cipoly</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='kw'>a.replin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>o</th>
      <td><p>an object of class <code>gamViz</code>, the output of a <code><a href='getViz.html'>getViz()</a></code> call.</p></td>
    </tr>
    <tr>
      <th>rep</th>
      <td><p>how many replicate datasets to generate to simulate quantiles of the residual distribution.
Relevant only if <code>method</code> is set to <code>"simul1"</code> or <code>"simul2"</code>.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>the level of the confidence intervals (e.g. 0.9 means 90% intervals).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>the method used to calculate the QQ-plot and, possibly, the confidence intervals. If set
to (<code>"tunif"</code>) <code>"tnormal"</code> the residuals are transformed to (uniform) normal, for which
analytic expression for the confidence intervals are available. If set to <code>"simul1"</code> or
<code>"simul2"</code> the theoretical QQ-line is constructed by simulating residuals from the model.
Method <code>"simul2"</code> does not produce confidence intervals. If set to <code>"normal"</code> no simulation
or transformation is performed, and a simple normal QQ-plot is produced. If set to <code>"auto"</code> the
method used to produce the QQ-plot is determined automatically.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>the type of residuals to be used. See <a href='residuals.gamViz.html'>residuals.gamViz</a>.</p></td>
    </tr>
    <tr>
      <th>CI</th>
      <td><p>the type of confidence intervals to be plotted. If set to <code>"none"</code> they are not added, if
set to <code>"normal"</code> they will be based on the assumption that the theoretical quantile
distribution is Gaussian and if set to <code>"quantile"</code> they will be sample quantiles of simulated
responses from the model.</p></td>
    </tr>
    <tr>
      <th>worm</th>
      <td><p>if <code>TRUE</code> a worm-plot (a de-trended QQ-plot) is plotted.</p></td>
    </tr>
    <tr>
      <th>showReps</th>
      <td><p>if <code>TRUE</code> all the QQ-lines corresponding to the simulated (model-based) QQ-plots.</p></td>
    </tr>
    <tr>
      <th>sortFun</th>
      <td><p>the function to be used for sorting the residuals. If left to <code>NULL</code> it will be set to
<code>function(.x) sort(.x, method = "quick")</code> internally.</p></td>
    </tr>
    <tr>
      <th>discrete</th>
      <td><p>if <code>TRUE</code> the QQ-plot is discretized into <code>ngr</code> bins before plotting,
in order to save plotting time (when the number of observations is large). If left
to <code>NULL</code>, the discretization is used if there are more than 10^4 observations.</p></td>
    </tr>
    <tr>
      <th>ngr</th>
      <td><p>number of bins to be used in the discretization.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>if supplied then this pair of numbers are used as the x limits for the plot.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>if supplied then this pair of numbers are used as the y limits for the plot.</p></td>
    </tr>
    <tr>
      <th>a.qqpoi</th>
      <td><p>list of arguments to be passed to <code><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>ggplot2::geom_point</a></code>, which plots the main QQ-plot.</p></td>
    </tr>
    <tr>
      <th>a.ablin</th>
      <td><p>list of arguments to be passed to <code><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>ggplot2::geom_abline</a></code>, which adds the reference line.</p></td>
    </tr>
    <tr>
      <th>a.cipoly</th>
      <td><p>list of arguments to be passed to <code><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>ggplot2::geom_polygon</a></code>, which add the confidence intervals.</p></td>
    </tr>
    <tr>
      <th>a.replin</th>
      <td><p>list of arguments to be passed to <code><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>ggplot2::geom_line</a></code>, which adds a line for each simulated
QQ-plot.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>currently unused.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code><a href='https://www.rdocumentation.org/packages/base/topics/c'>c("qqGam", "plotSmooth", "gg")</a></code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Here <code>method = "simul1"</code> corresponds to the algorithm described in section 2.1 of Augustin et al. (2012), which
involves direct simulations of residuals from the models. This requires <code>o$family$rd</code> to be defined.
Setting <code>method = "simul2"</code> results in a cheaper method, described in section 2.2 of Augustin et al. (2012),
which requires <code>o$family$qf</code> to be defined.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Augustin, N.H., Sauleau, E.A. and Wood, S.N., 2012. On quantile quantile plots for generalized linear models.
Computational Statistics &amp; Data Analysis, 56(8), pp.2404-2409.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>######## Example: simulate binomial data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>mgcViz</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>0</span>)
<span class='no'>n.samp</span> <span class='kw'>&lt;-</span> <span class='fl'>400</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>gamSim</span>(<span class='fl'>1</span>,<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n.samp</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"binary"</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>.33</span>)</div><div class='output co'>#&gt; Gu &amp; Wahba 4 term additive model</div><div class='input'><span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/family'>binomial</a></span>()$<span class='fu'>linkinv</span>(<span class='no'>dat</span>$<span class='no'>f</span>) <span class='co'>## binomial p</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>3</span>), <span class='no'>n.samp</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'>## binomial n</span>
<span class='no'>dat</span>$<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Binomial'>rbinom</a></span>(<span class='no'>n</span>, <span class='no'>n</span>, <span class='no'>p</span>)
<span class='no'>dat</span>$<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='no'>n</span>
<span class='no'>lr.fit</span> <span class='kw'>&lt;-</span> <span class='fu'>gam</span>(<span class='no'>y</span>/<span class='no'>n</span> ~ <span class='fu'>s</span>(<span class='no'>x0</span>) + <span class='fu'>s</span>(<span class='no'>x1</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>) + <span class='fu'>s</span>(<span class='no'>x3</span>)
              , <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>binomial</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>,
              <span class='kw'>weights</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"REML"</span>)
<span class='no'>lr.fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>lr.fit</span>)

<span class='co'># Quick QQ-plot of deviance residuals</span>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>lr.fit</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul2"</span>)</div><div class='img'><img src='qq.gamViz-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Same, but changing points share and type of reference list</span>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>lr.fit</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul2"</span>,
       <span class='kw'>a.qqpoi</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"shape"</span> <span class='kw'>=</span> <span class='fl'>1</span>), <span class='kw'>a.ablin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"linetype"</span> <span class='kw'>=</span> <span class='fl'>2</span>))</div><div class='img'><img src='qq.gamViz-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Simulation based QQ-plot with reference bands </span>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>lr.fit</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>.9</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"quantile"</span>)</div><div class='img'><img src='qq.gamViz-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Simulation based QQ-plot, Pearson resids, all simulations lines shown </span>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>lr.fit</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>,
       <span class='kw'>a.qqpoi</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>19</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='qq.gamViz-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Now fit the wrong model and check</span>
<span class='no'>pif</span> <span class='kw'>&lt;-</span> <span class='fu'>gam</span>(<span class='no'>y</span> ~ <span class='fu'>s</span>(<span class='no'>x0</span>) + <span class='fu'>s</span>(<span class='no'>x1</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>) + <span class='fu'>s</span>(<span class='no'>x3</span>)
           , <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>poisson</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"REML"</span>)
<span class='no'>pif</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>pif</span>)

<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>pif</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul2"</span>)</div><div class='img'><img src='qq.gamViz-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>pif</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>.9</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"quantile"</span>)</div><div class='img'><img src='qq.gamViz-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>pif</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
               <span class='kw'>a.qqpoi</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>19</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='img'><img src='qq.gamViz-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>######## Example: binary data model violation so gross that you see a problem </span>
<span class='co'>######## on the QQ plot</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>10</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>20</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>40</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>10</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>40</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>40</span>))
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='fl'>160</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></span>(<span class='no'>y</span> ~ <span class='no'>x</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>binomial</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/class'>class</a></span>(<span class='no'>b</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"gamViz"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/class'>class</a></span>(<span class='no'>b</span>)) <span class='co'># Tricking qq.gamViz to use it on a glm</span>

<span class='co'># Note that the next two are not necessarily similar under gross </span>
<span class='co'># model violation...</span>
<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>b</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul2"</span>)</div><div class='img'><img src='qq.gamViz-8.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>b</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='qq.gamViz-9.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### alternative model</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'>gam</span>(<span class='no'>y</span> ~ <span class='fu'>s</span>(<span class='no'>x</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>5</span>), <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>binomial</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ML"</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>b</span>)

<span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>b</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul2"</span>)</div><div class='img'><img src='qq.gamViz-10.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>b</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>19</span>)</div><div class='img'><img src='qq.gamViz-11.png' alt='' width='700' height='433' /></div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'>########  "Big Data" example: </span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>0</span>)
<span class='no'>n.samp</span> <span class='kw'>&lt;-</span> <span class='fl'>50000</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>gamSim</span>(<span class='fl'>1</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='no'>n.samp</span>,<span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"binary"</span>,<span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>.33</span>)
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/family'>binomial</a></span>()$<span class='fu'>linkinv</span>(<span class='no'>dat</span>$<span class='no'>f</span>) <span class='co'>## binomial p</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>3</span>),<span class='no'>n.samp</span>,<span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'>## binomial n</span>
<span class='no'>dat</span>$<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Binomial'>rbinom</a></span>(<span class='no'>n</span>,<span class='no'>n</span>,<span class='no'>p</span>)
<span class='no'>dat</span>$<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='no'>n</span>
<span class='no'>lr.fit</span> <span class='kw'>&lt;-</span> <span class='fu'>bam</span>(<span class='no'>y</span>/<span class='no'>n</span> ~ <span class='fu'>s</span>(<span class='no'>x0</span>) + <span class='fu'>s</span>(<span class='no'>x1</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>) + <span class='fu'>s</span>(<span class='no'>x3</span>)
              , <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>binomial</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>,
              <span class='kw'>weights</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"fREML"</span>, <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>lr.fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>lr.fit</span>)

<span class='co'># Turning discretization off (on by default for large datasets).</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>414</span>) <span class='co'># Setting the seed because qq.gamViz is doing simulations</span>
<span class='no'>o</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>lr.fit</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul1"</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"normal"</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
            <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>a.replin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.1</span>))
<span class='no'>o</span> <span class='co'># This might take some time!</span>

<span class='co'># Using default discretization</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>414</span>)
<span class='no'>o</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>lr.fit</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul1"</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"normal"</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
            <span class='kw'>a.replin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.1</span>))
<span class='no'>o</span> <span class='co'># Much faster plotting!</span>

<span class='co'># Very coarse discretization</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>414</span>)
<span class='no'>o</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='qq.html'>qq</a></span>(<span class='no'>lr.fit</span>, <span class='kw'>rep</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"simul1"</span>, <span class='kw'>CI</span> <span class='kw'>=</span> <span class='st'>"normal"</span>, <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
            <span class='kw'>ngr</span> <span class='kw'>=</span> <span class='fl'>1e2</span>, <span class='kw'>a.replin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.1</span>), <span class='kw'>a.qqpoi</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>19</span>))
<span class='no'>o</span>

<span class='co'># We can also zoom in at no extra costs (most work already done by qq.gamViz)</span>
<span class='fu'><a href='zoom.html'>zoom</a></span>(<span class='no'>o</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>0.25</span>, <span class='fl'>0.25</span>), <span class='kw'>showReps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>a.replin</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.2</span>))
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo, Raphael Nedellec.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

