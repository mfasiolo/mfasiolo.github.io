<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Basic GAM plotting — plot.gamViz • mgcViz</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Basic GAM plotting — plot.gamViz" />

<meta property="og:description" content="This function is the mgcViz equivalent of plot.gam. It is the workhorse of the
mgcViz package, and allows plotting (almost) any type of smooth,
parametric or random effects. It is basically a wrapper around plotting
methods that are specific to individual smooth effect classes (such as
plot.mgcv.smooth.1D and plot.random.effect)." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mgcViz</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mgcviz.html">mgcViz: visual tools for GAMs</a>
    </li>
    <li>
      <a href="../articles/miscellanea.html">Miscellanea: things you can do in mgcViz</a>
    </li>
    <li>
      <a href="../articles/qgam_mgcViz.html">Quantile additive models using qgam and mgcViz</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mfasiolo/mgcViz">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Basic GAM plotting</h1>
    <small class="dont-index">Source: <a href='https://github.com/mfasiolo/mgcViz/blob/master/R/plot_gamViz.R'><code>R/plot_gamViz.R</code></a></small>
    <div class="hidden name"><code>plot.gamViz.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function is the <code>mgcViz</code> equivalent of plot.gam. It is the workhorse of the
<code>mgcViz</code> package, and allows plotting (almost) any type of smooth,
parametric or random effects. It is basically a wrapper around plotting
methods that are specific to individual smooth effect classes (such as
<a href='plot.mgcv.smooth.1D.html'>plot.mgcv.smooth.1D</a> and <a href='plot.random.effect.html'>plot.random.effect</a>).</p>
    
    </div>

    <pre class="usage"><span class='co'># S3 method for gamViz</span>
<span class='fu'>plot</span>(<span class='no'>x</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>n2</span> <span class='kw'>=</span> <span class='fl'>40</span>, <span class='kw'>select</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>allTerms</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object of class <code>gamViz</code>, the output of a <a href='getViz.html'>getViz</a> call.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of points used for each 1-d plot. For a nice smooth plot
this needs to be several times the estimated degrees of freedom for the smooth.</p></td>
    </tr>
    <tr>
      <th>n2</th>
      <td><p>square root of number of grid points used for plotting 2D functions effects
using contours or heatmaps.</p></td>
    </tr>
    <tr>
      <th>select</th>
      <td><p>allows plotting a subset of model terms. For instance, if you just want the plot
for the second smooth term, set <code>select = 2</code>. Parametric effects always come
after smooth or random effects.</p></td>
    </tr>
    <tr>
      <th>allTerms</th>
      <td><p>if <code>TRUE</code> also the parametric effects will be plotted.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters, such as <code>maxpo</code> or <code>trans</code>, to be passed to the specific
plotting methods for each effect (e.g. to <a href='plot.mgcv.smooth.1D.html'>plot.mgcv.smooth.1D</a>).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>c("plotGam", "gg")</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>mgcViz</span>)

<span class='co'>######## Basic example</span>
<span class='co'># Simulate some data and fit model</span>
<span class='fu'>set.seed</span>(<span class='fl'>2</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>gamSim</span>(<span class='fl'>1</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>1e3</span>,<span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"normal"</span>,<span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='output co'>#&gt; Gu &amp; Wahba 4 term additive model</div><div class='input'><span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'>bam</span>(<span class='no'>y</span>~<span class='fu'>s</span>(<span class='no'>x0</span>)+<span class='fu'>s</span>(<span class='no'>x1</span>, <span class='no'>x2</span>)+<span class='fu'>s</span>(<span class='no'>x3</span>), <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>b</span>)

<span class='co'># Default smooth effect plotting</span>
<span class='fu'>print</span>(<span class='fu'>plot</span>(<span class='no'>b</span>), <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='plot.gamViz-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='plot.gamViz-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='plot.gamViz-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Now on one page and with out title on the second plot</span>
<span class='fu'>print</span>(<span class='fu'>plot</span>(<span class='no'>b</span>) + <span class='fu'>labs</span>(<span class='kw'>title</span> <span class='kw'>=</span> <span class='kw'>NULL</span>), <span class='kw'>pages</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='img'><img src='plot.gamViz-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># So far we used default layers, added in the printing phase, but</span>
<span class='co'># we might want to specify our own layers. Here we is how to do it</span>
<span class='no'>pl</span> <span class='kw'>&lt;-</span> <span class='fu'>plot</span>(<span class='no'>b</span>) + <span class='fu'><a href='l_points.html'>l_points</a></span>() + <span class='fu'><a href='l_fitLine.html'>l_fitLine</a></span>(<span class='kw'>linetype</span> <span class='kw'>=</span> <span class='fl'>3</span>) + <span class='fu'><a href='l_fitContour.html'>l_fitContour</a></span>() +
  <span class='fu'><a href='l_ciLine.html'>l_ciLine</a></span>(<span class='kw'>colour</span> <span class='kw'>=</span> <span class='fl'>2</span>) + <span class='fu'>theme_get</span>() + <span class='fu'>labs</span>(<span class='kw'>title</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)
<span class='fu'>print</span>(<span class='no'>pl</span>, <span class='kw'>pages</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='img'><img src='plot.gamViz-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># We might want to plot only the first smooth</span>
<span class='fu'>plot</span>(<span class='no'>b</span>, <span class='kw'>select</span> <span class='kw'>=</span> <span class='fl'>1</span>) + <span class='fu'><a href='l_dens.html'>l_dens</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"cond"</span>) + <span class='fu'><a href='l_fitLine.html'>l_fitLine</a></span>() + <span class='fu'><a href='l_ciLine.html'>l_ciLine</a></span>()</div><div class='img'><img src='plot.gamViz-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>######## Example with "by variable" smooth effect</span>
<span class='co'># Simulate data and fit model</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>gamSim</span>(<span class='fl'>4</span>)</div><div class='output co'>#&gt; Factor `by' variable example</div><div class='input'><span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'>gam</span>(<span class='no'>y</span> ~ <span class='no'>fac</span>+<span class='fu'>s</span>(<span class='no'>x2</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='no'>fac</span>)+<span class='fu'>s</span>(<span class='no'>x0</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>b</span>)
<span class='co'># print() only needed because we want to plot on a single page</span>
<span class='fu'>print</span>(<span class='fu'>plot</span>(<span class='no'>b</span>), <span class='kw'>pages</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='img'><img src='plot.gamViz-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>print</span>(<span class='fu'>plot</span>(<span class='no'>b</span>, <span class='kw'>allTerms</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>pages</span> <span class='kw'>=</span> <span class='fl'>1</span>) <span class='co'># Including also parametric effect</span></div><div class='img'><img src='plot.gamViz-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>######## Example with 3D smooth effect which cannot be plotted</span>
<span class='co'># Simulate data and fit model</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>5e3</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>n</span>); <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>n</span>); <span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>n</span>); <span class='no'>z2</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>n</span>)

<span class='no'>ob</span> <span class='kw'>&lt;-</span> (<span class='no'>x</span>-<span class='no'>z</span>)^<span class='fl'>2</span> + (<span class='no'>y</span>-<span class='no'>z</span>)^<span class='fl'>2</span> + <span class='no'>z2</span>^<span class='fl'>3</span> + <span class='fu'>rnorm</span>(<span class='no'>n</span>)
<span class='no'>b1</span> <span class='kw'>&lt;-</span> <span class='fu'>bam</span>(<span class='no'>ob</span> ~ <span class='fu'>s</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>z</span>) + <span class='fu'>s</span>(<span class='no'>z2</span>), <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>b1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>b1</span>)

<span class='co'># Only second effect get plotted</span>
<span class='fu'>plot</span>(<span class='no'>b1</span>)</div><div class='img'><img src='plot.gamViz-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># In fact this does not plot anything</span>
<span class='fu'>plot</span>(<span class='no'>b1</span>, <span class='kw'>select</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='message'>Nothing to plot!</span></div><div class='input'><span class='co'># For plotting effects with more than 2D, one we need specific method. </span>
<span class='co'># See ?plot.mgcv.smooth.MD</span>

<span class='co'>######## Examples about plotting parametric effects</span>
<span class='co'># 1 Gaussian GAM</span>
<span class='fu'>set.seed</span>(<span class='fl'>3</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>gamSim</span>(<span class='fl'>1</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>2500</span>,<span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"normal"</span>,<span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>20</span>)</div><div class='output co'>#&gt; Gu &amp; Wahba 4 term additive model</div><div class='input'><span class='no'>dat</span>$<span class='no'>fac</span> <span class='kw'>&lt;-</span> <span class='fu'>as.factor</span>( <span class='fu'>sample</span>(<span class='fu'>c</span>(<span class='st'>"A1"</span>, <span class='st'>"A2"</span>, <span class='st'>"A3"</span>), <span class='fu'>nrow</span>(<span class='no'>dat</span>), <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) )
<span class='no'>dat</span>$<span class='no'>logi</span> <span class='kw'>&lt;-</span> <span class='fu'>as.logical</span>( <span class='fu'>sample</span>(<span class='fu'>c</span>(<span class='fl'>TRUE</span>, <span class='fl'>FALSE</span>), <span class='fu'>nrow</span>(<span class='no'>dat</span>), <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) )
<span class='no'>bs</span> <span class='kw'>&lt;-</span> <span class='st'>"cr"</span>; <span class='no'>k</span> <span class='kw'>&lt;-</span> <span class='fl'>12</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'>bam</span>(<span class='no'>y</span> ~ <span class='no'>x0</span> + <span class='no'>x1</span> + <span class='fu'>I</span>(<span class='no'>x1</span>^<span class='fl'>2</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>,<span class='kw'>bs</span><span class='kw'>=</span><span class='no'>bs</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='no'>k</span>) + <span class='no'>fac</span> + <span class='no'>x3</span>:<span class='no'>fac</span> + <span class='fu'>I</span>(<span class='no'>x1</span>*<span class='no'>x2</span>) + <span class='no'>logi</span> +
            <span class='fu'>s</span>(<span class='no'>x3</span>, <span class='kw'>bs</span><span class='kw'>=</span><span class='no'>bs</span>),<span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>b</span>)

<span class='co'># All effects in one page. Notably 'x3:fac' is missing: we have no methods</span>
<span class='co'># for plotting second order effects.</span>
<span class='fu'>print</span>(<span class='fu'>plot</span>(<span class='no'>b</span>, <span class='kw'>allTerms</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>pages</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='img'><img src='plot.gamViz-10.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Plotting only parametric effects</span>
<span class='fu'>print</span>(<span class='fu'>plot</span>(<span class='no'>b</span>, <span class='kw'>select</span> <span class='kw'>=</span> <span class='fl'>3</span>:<span class='fl'>9</span>), <span class='kw'>pages</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='img'><img src='plot.gamViz-11.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># 2 GAMLSS Gaussian model</span>
<span class='fu'>library</span>(<span class='no'>mgcv</span>);<span class='fu'>library</span>(<span class='no'>MASS</span>)
<span class='no'>mcycle</span>$<span class='no'>fac</span> <span class='kw'>&lt;-</span> <span class='fu'>as.factor</span>( <span class='fu'>sample</span>(<span class='fu'>c</span>(<span class='st'>"z"</span>, <span class='st'>"k"</span>, <span class='st'>"a"</span>, <span class='st'>"f"</span>), <span class='fu'>nrow</span>(<span class='no'>mcycle</span>), <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) )
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/mgcv/topics/gam'>gam</a></span>(<span class='fu'>list</span>(<span class='no'>accel</span>~<span class='no'>times</span> + <span class='fu'>I</span>(<span class='no'>times</span>^<span class='fl'>2</span>) + <span class='fu'><a href='http://www.rdocumentation.org/packages/mgcv/topics/s'>s</a></span>(<span class='no'>times</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>10</span>), ~ <span class='no'>times</span> + <span class='no'>fac</span> + <span class='fu'><a href='http://www.rdocumentation.org/packages/mgcv/topics/s'>s</a></span>(<span class='no'>times</span>)),
          <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mcycle</span>,<span class='kw'>family</span><span class='kw'>=</span><span class='fu'><a href='http://www.rdocumentation.org/packages/mgcv/topics/gaulss'>gaulss</a></span>())
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>b</span>)

<span class='co'># All effects on one page: effect of second linear predictor end with '.1'</span>
<span class='fu'>print</span>(<span class='fu'>plot</span>(<span class='no'>b</span>, <span class='kw'>allTerms</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>pages</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='img'><img src='plot.gamViz-12.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo, Raphael Nedellec.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

