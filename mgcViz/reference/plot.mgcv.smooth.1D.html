<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plotting one dimensional smooth effects — plot.mgcv.smooth.1D • mgcViz</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plotting one dimensional smooth effects — plot.mgcv.smooth.1D" />
<meta property="og:description" content="Plotting method for one dimensional smooth effects." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mgcViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/BayesPost.html">Bayesian posterior simulations and predictive checks</a>
    </li>
    <li>
      <a href="../articles/mgcviz.html">An introduction to mgcViz: visual tools for GAMs</a>
    </li>
    <li>
      <a href="../articles/miscellanea.html">Miscellanea: things you can do in mgcViz</a>
    </li>
    <li>
      <a href="../articles/qgam_mgcViz.html">Quantile additive models using qgam and mgcViz</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mfasiolo/mgcViz">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plotting one dimensional smooth effects</h1>
    <small class="dont-index">Source: <a href='https://github.com/mfasiolo/mgcViz/blob/master/R/plot_mgcv_smooth_1D.R'><code>R/plot_mgcv_smooth_1D.R</code></a>, <a href='https://github.com/mfasiolo/mgcViz/blob/master/R/plot_multi_mgcv_smooth_1D.R'><code>R/plot_multi_mgcv_smooth_1D.R</code></a></small>
    <div class="hidden name"><code>plot.mgcv.smooth.1D.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plotting method for one dimensional smooth effects.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for mgcv.smooth.1D</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(
  <span class='no'>x</span>,
  <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>maxpo</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>trans</span> <span class='kw'>=</span> <span class='no'>identity</span>,
  <span class='kw'>unconditional</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>seWithMean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='no'>...</span>
)

<span class='co'># S3 method for multi.mgcv.smooth.1D</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(
  <span class='no'>x</span>,
  <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>maxpo</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>trans</span> <span class='kw'>=</span> <span class='no'>identity</span>,
  <span class='kw'>unconditional</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>seWithMean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>asFact</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a smooth effect object, extracted using <a href='sm.html'>mgcViz::sm</a>.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of grid points used to compute main effect and c.i. lines.
For a nice smooth plot this needs to be several times the estimated degrees of
freedom for the smooth.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>if supplied then this pair of numbers are used as the x limits for the plot.</p></td>
    </tr>
    <tr>
      <th>maxpo</th>
      <td><p>maximum number of residuals points that will be used by layers such as
<code>resRug()</code> and <code>resPoints()</code>. If number of datapoints &gt; <code>maxpo</code>,
then a subsample of <code>maxpo</code> points will be taken.</p></td>
    </tr>
    <tr>
      <th>trans</th>
      <td><p>monotonic function to apply to the smooth and residuals, before plotting.
Monotonicity is not checked.</p></td>
    </tr>
    <tr>
      <th>unconditional</th>
      <td><p>if <code>TRUE</code> then the smoothing parameter uncertainty corrected covariance
matrix is used to compute uncertainty bands, if available.
Otherwise the bands treat the smoothing parameters as fixed.</p></td>
    </tr>
    <tr>
      <th>seWithMean</th>
      <td><p>if TRUE the component smooths are shown with confidence intervals that
include the uncertainty about the overall mean. If FALSE then the uncertainty
relates purely to the centred smooth itself. Marra and Wood (2012) suggests
that TRUE results in better coverage performance, and this is also suggested
by simulation.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>number of smooth effect curves to be simulated from the posterior distribution.
These can be plotted using the <a href='l_simLine.html'>l_simLine</a> layer. See Examples section below.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>currently unused.</p></td>
    </tr>
    <tr>
      <th>asFact</th>
      <td><p>determines whether to use a factor or colour bar legend for plot.multi.mgcv.smooth.1D.
When working with models fitted with <a href='mqgamV.html'>mqgamV</a>, the default is
<code>FALSE</code> for less than 10 quantiles, <code>TRUE</code> otherwise. For other models the
default is <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An objects of class <code>plotSmooth</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Marra, G and S.N. Wood (2012) Coverage Properties of Confidence Intervals for
Generalized Additive Model Components. Scandinavian Journal of Statistics.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>mgcViz</span>)
<span class='no'>n</span>  <span class='kw'>&lt;-</span> <span class='fl'>1e3</span>
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='st'>"x1"</span> <span class='kw'>=</span> <span class='no'>x1</span>, <span class='st'>"x2"</span> <span class='kw'>=</span> <span class='no'>x2</span>,
                  <span class='st'>"y"</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span>(<span class='no'>x1</span>) + <span class='fl'>0.5</span> * <span class='no'>x2</span>^<span class='fl'>2</span> + <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>pmax</a></span>(<span class='no'>x2</span>, <span class='fl'>0.2</span>) * <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>))
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gamV.html'>bamV</a></span>(<span class='no'>y</span> ~ <span class='fu'>s</span>(<span class='no'>x1</span>)+<span class='fu'>s</span>(<span class='no'>x2</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"fREML"</span>, <span class='kw'>aGam</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>discrete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))

<span class='no'>o</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='sm.html'>sm</a></span>(<span class='no'>b</span>, <span class='fl'>1</span>), <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>50</span>) <span class='co'># 50 posterior simulations </span>

<span class='co'># Plot with fitted effect + posterior simulations + rug on x axis</span>
( <span class='no'>o</span> <span class='kw'>&lt;-</span> <span class='no'>o</span> + <span class='fu'><a href='l_simLine.html'>l_simLine</a></span>() + <span class='fu'><a href='l_fitLine.html'>l_fitLine</a></span>(<span class='kw'>colour</span> <span class='kw'>=</span> <span class='st'>"red"</span>) +
       <span class='fu'><a href='l_rug.html'>l_rug</a></span>(<span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.8</span>) )</div><div class='img'><img src='plot.mgcv.smooth.1D-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Add CI lines at 1*sigma and 5*sigma</span>
( <span class='no'>o</span> <span class='kw'>&lt;-</span> <span class='no'>o</span> + <span class='fu'><a href='l_ciLine.html'>l_ciLine</a></span>(<span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>1</span>) + <span class='fu'><a href='l_ciLine.html'>l_ciLine</a></span>(<span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>colour</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>linetype</span> <span class='kw'>=</span> <span class='fl'>2</span>) )</div><div class='img'><img src='plot.mgcv.smooth.1D-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Add partial residuals and change theme</span>
( <span class='no'>o</span> + <span class='fu'><a href='l_points.html'>l_points</a></span>(<span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>19</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.2</span>) + <span class='fu'>theme_classic</span>() )</div><div class='img'><img src='plot.mgcv.smooth.1D-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Get second effect plot</span>
<span class='no'>o2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>( <span class='fu'><a href='sm.html'>sm</a></span>(<span class='no'>b</span>, <span class='fl'>2</span>) )

<span class='co'># Plot it with polygon for partial residuals</span>
<span class='no'>o2</span> + <span class='fu'><a href='l_ciPoly.html'>l_ciPoly</a></span>(<span class='kw'>mul</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='st'>"light blue"</span>) +
  <span class='fu'><a href='l_fitLine.html'>l_fitLine</a></span>(<span class='kw'>linetype</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>colour</span> <span class='kw'>=</span> <span class='st'>"red"</span>)</div><div class='img'><img src='plot.mgcv.smooth.1D-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Plot is with conditional density of partial residuals</span>
<span class='no'>o2</span> + <span class='fu'><a href='l_dens2D.html'>l_dens</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"cond"</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)  +
  <span class='fu'><a href='l_fitLine.html'>l_fitLine</a></span>(<span class='kw'>linetype</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>colour</span> <span class='kw'>=</span> <span class='st'>"red"</span>)</div><div class='img'><img src='plot.mgcv.smooth.1D-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>########</span>
<span class='co'># Quantile GAM example</span>
<span class='co'>########</span>
<span class='co'># Fit model</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mqgamV.html'>mqgamV</a></span>(<span class='no'>y</span> ~ <span class='fu'>s</span>(<span class='no'>x1</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>), <span class='kw'>qu</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.2</span>, <span class='fl'>0.5</span>, <span class='fl'>0.8</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>)</div><div class='output co'>#&gt; Estimating learning rate. Each dot corresponds to a loss evaluation. 
#&gt; qu = 0.5..........done 
#&gt; qu = 0.2...............done 
#&gt; qu = 0.8.............</div><div class='output co'>#&gt; <span class='message'>qu = 0.8, log(sigma) = -1.813253 : outer Newton did not converge fully.</span></div><div class='output co'>#&gt; ...</div><div class='output co'>#&gt; <span class='message'>qu = 0.8, log(sigma) = -1.813391 : outer Newton did not converge fully.</span></div><div class='output co'>#&gt; .</div><div class='output co'>#&gt; <span class='message'>qu = 0.8, log(sigma) = -1.812786 : outer Newton did not converge fully.</span></div><div class='output co'>#&gt; .done </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='sm.html'>sm</a></span>(<span class='no'>b</span>, <span class='fl'>1</span>)) + <span class='fu'><a href='l_fitLine.html'>l_fitLine</a></span>(<span class='kw'>linetype</span> <span class='kw'>=</span> <span class='fl'>2</span>) + <span class='fu'><a href='l_rug.html'>l_rug</a></span>(<span class='kw'>colour</span> <span class='kw'>=</span> <span class='st'>"blue"</span>)</div><div class='img'><img src='plot.mgcv.smooth.1D-6.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo, Raphael Nedellec.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


